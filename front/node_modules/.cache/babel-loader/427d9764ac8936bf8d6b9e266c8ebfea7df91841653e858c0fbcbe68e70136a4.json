{"ast":null,"code":"import React,{useEffect}from\"react\";import MainLayout from\"../../components/MainLayout\";import{Link,useNavigate}from\"react-router-dom\";import{useForm}from\"react-hook-form\";import{useMutation}from\"@tanstack/react-query\";import{login}from\"../../services/index/users\";import{useDispatch,useSelector}from\"react-redux\";import{userActions}from\"../../store/reducers/userReducers\";import toast from\"react-hot-toast\";import\"./login.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Login=()=>{var _errors$email,_errors$password;const navigate=useNavigate();const dispatch=useDispatch();const userState=useSelector(state=>state.user);//creating a mutation to login a user\nconst{mutate,isLoading}=useMutation({mutationFn:_ref=>{let{email,password}=_ref;return login({email,password});},//after getting the data from the mutation this function run\nonSuccess:data=>{dispatch(userActions.setUserInfo(data));//saving the data in the local storage to better experience\nlocalStorage.setItem(\"account\",JSON.stringify(data));toast.success(\"Login Successful\");console.log(data);},// trowing an error\nonError:error=>{toast.error(error.message);console.log(error);}});//useEffect Redirect the User to Home upon successfull login\nuseEffect(()=>{if(userState.userInfo){navigate(-1);}},[navigate,userState.userInfo]);const{register,handleSubmit,formState:{errors,isValid}}=useForm({defaultValues:{email:\"\",password:\"\"},mode:\"onChange\"});//getting the data from the form\nconst submitHandler=data=>{const{email,password}=data;mutate({email,password});};return/*#__PURE__*/_jsx(MainLayout,{children:/*#__PURE__*/_jsx(\"section\",{className:\"login-acct\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(submitHandler),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"email\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email\"// creating validation for the EMAIL\n,...register(\"email\",{required:{value:true,message:\"Email is required\"},pattern:{value:/^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/,message:\"Enter a valid email\"}}),placeholder:\"Enter your email\",className:\"\".concat(errors.name?\"error-border\":\"no-error\")}),((_errors$email=errors.email)===null||_errors$email===void 0?void 0:_errors$email.message)&&/*#__PURE__*/_jsx(\"p\",{className:\"error-reg\",children:errors.email.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"password\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",...register(\"password\",{minLength:{value:6,message:\"Password must be at least 6 characters\"},required:{value:true,message:\"Password is required\"}}),placeholder:\"Enter your password\",className:\"\".concat(errors.password?\"error-border\":\"no-error\")}),((_errors$password=errors.password)===null||_errors$password===void 0?void 0:_errors$password.message)&&/*#__PURE__*/_jsx(\"p\",{className:\"error-reg\",children:errors.password.message})]}),/*#__PURE__*/_jsx(Link,{to:\"/forgot-password\",className:\"forgot\",children:\"Forgot Password\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:!isValid||isLoading,className:\"btn-login \".concat(isValid?\"enabled\":\"disabled\"),children:\"Login\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"have-account\",children:[\"Don't have an account?\",\" \",/*#__PURE__*/_jsx(Link,{to:\"/register\",className:\"login-btn\",children:\"Register\"})]})]})]})})});};export default Login;","map":{"version":3,"names":["React","useEffect","MainLayout","Link","useNavigate","useForm","useMutation","login","useDispatch","useSelector","userActions","toast","jsx","_jsx","jsxs","_jsxs","Login","_errors$email","_errors$password","navigate","dispatch","userState","state","user","mutate","isLoading","mutationFn","_ref","email","password","onSuccess","data","setUserInfo","localStorage","setItem","JSON","stringify","success","console","log","onError","error","message","userInfo","register","handleSubmit","formState","errors","isValid","defaultValues","mode","submitHandler","children","className","onSubmit","htmlFor","type","id","required","value","pattern","placeholder","concat","name","minLength","to","disabled"],"sources":["C:/Users/moral/Desktop/Capstone Project JAR/JAR/src/pages/login/Login.jsx"],"sourcesContent":["import React, { useEffect } from \"react\";\r\nimport MainLayout from \"../../components/MainLayout\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { useMutation } from \"@tanstack/react-query\";\r\nimport { login } from \"../../services/index/users\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { userActions } from \"../../store/reducers/userReducers\";\r\nimport toast from \"react-hot-toast\";\r\nimport \"./login.css\";\r\n\r\nconst Login = () => {\r\n   const navigate = useNavigate();\r\n   const dispatch = useDispatch();\r\n   const userState = useSelector((state) => state.user);\r\n   //creating a mutation to login a user\r\n   const { mutate, isLoading } = useMutation({\r\n      mutationFn: ({ email, password }) => {\r\n         return login({ email, password });\r\n      },\r\n\r\n      //after getting the data from the mutation this function run\r\n      onSuccess: (data) => {\r\n         dispatch(userActions.setUserInfo(data));\r\n         //saving the data in the local storage to better experience\r\n         localStorage.setItem(\"account\", JSON.stringify(data));\r\n         toast.success(\"Login Successful\");\r\n         console.log(data);\r\n      },\r\n      // trowing an error\r\n      onError: (error) => {\r\n         toast.error(error.message);\r\n         console.log(error);\r\n      },\r\n   });\r\n\r\n   //useEffect Redirect the User to Home upon successfull login\r\n\r\n   useEffect(() => {\r\n      if (userState.userInfo) {\r\n         navigate(-1);\r\n      }\r\n   }, [navigate, userState.userInfo]);\r\n\r\n   const {\r\n      register,\r\n      handleSubmit,\r\n      formState: { errors, isValid },\r\n   } = useForm({\r\n      defaultValues: {\r\n         email: \"\",\r\n         password: \"\",\r\n      },\r\n      mode: \"onChange\",\r\n   });\r\n\r\n   //getting the data from the form\r\n   const submitHandler = (data) => {\r\n      const { email, password } = data;\r\n      mutate({\r\n         email,\r\n         password,\r\n      });\r\n   };\r\n\r\n   return (\r\n      <MainLayout>\r\n         <section className=\"login-acct\">\r\n            <div className=\"login-container\">\r\n               <h1>Login</h1>\r\n               <form onSubmit={handleSubmit(submitHandler)}>\r\n                  {/* FOR EMAIL */}\r\n                  <div className=\"email\">\r\n                     <label htmlFor=\"email\">Email</label>\r\n\r\n                     <input\r\n                        type=\"email\"\r\n                        id=\"email\"\r\n                        // creating validation for the EMAIL\r\n                        {...register(\"email\", {\r\n                           required: {\r\n                              value: true,\r\n                              message: \"Email is required\",\r\n                           },\r\n                           pattern: {\r\n                              value: /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/,\r\n                              message: \"Enter a valid email\",\r\n                           },\r\n                        })}\r\n                        placeholder=\"Enter your email\"\r\n                        className={`${\r\n                           errors.name ? \"error-border\" : \"no-error\"\r\n                        }`}\r\n                     />\r\n                     {errors.email?.message && (\r\n                        <p className=\"error-reg\">{errors.email.message}</p>\r\n                     )}\r\n                  </div>\r\n\r\n                  {/* FOR PASSWORD */}\r\n                  <div className=\"password\">\r\n                     <label htmlFor=\"password\">Password</label>\r\n\r\n                     <input\r\n                        type=\"password\"\r\n                        id=\"password\"\r\n                        {...register(\"password\", {\r\n                           minLength: {\r\n                              value: 6,\r\n                              message: \"Password must be at least 6 characters\",\r\n                           },\r\n                           required: {\r\n                              value: true,\r\n                              message: \"Password is required\",\r\n                           },\r\n                        })}\r\n                        placeholder=\"Enter your password\"\r\n                        className={`${\r\n                           errors.password ? \"error-border\" : \"no-error\"\r\n                        }`}\r\n                     />\r\n                     {errors.password?.message && (\r\n                        <p className=\"error-reg\">{errors.password.message}</p>\r\n                     )}\r\n                  </div>\r\n\r\n                  {/* FOR FORGOT PASSWORD */}\r\n                  <Link to=\"/forgot-password\" className=\"forgot\">\r\n                     Forgot Password\r\n                  </Link>\r\n\r\n                  {/* FOR SUBMIT BUTTON */}\r\n                  <button\r\n                     type=\"submit\"\r\n                     disabled={!isValid || isLoading}\r\n                     className={`btn-login ${isValid ? \"enabled\" : \"disabled\"}`}\r\n                  >\r\n                     Login\r\n                  </button>\r\n\r\n                  {/* FOR ALREADY HAVE AN ACCOUNT */}\r\n                  <p className=\"have-account\">\r\n                     Don't have an account?{\" \"}\r\n                     <Link to=\"/register\" className=\"login-btn\">\r\n                        Register\r\n                     </Link>\r\n                  </p>\r\n               </form>\r\n            </div>\r\n         </section>\r\n      </MainLayout>\r\n   );\r\n};\r\n\r\nexport default Login;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import React,{useState}from\"react\";import{createPortal}from\"react-dom\";import{stables}from\"../constants\";import{IoPersonCircleOutline}from\"react-icons/io5\";import\"./css/profilepicture.css\";import CropEasy from\"./crop/CropEasy\";import{updateProfilePicture}from\"../services/index/users\";import{useMutation,useQueryClient}from\"@tanstack/react-query\";import{useDispatch,useSelector}from\"react-redux\";import toast from\"react-hot-toast\";import{userActions}from\"../store/reducers/userReducers\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const ProfilePicture=props=>{const{avatar}=props;const queryClient=useQueryClient();const dispatch=useDispatch();const userState=useSelector(state=>state.user);const[openCrop,setOpenCrop]=useState(false);const[photo,setPhoto]=useState(null);const{mutate,isLoading}=useMutation({mutationFn:_ref=>{let{token,formData}=_ref;return updateProfilePicture({token:token,formData:formData});},onSuccess:data=>{dispatch(userActions.setUserInfo(data));setOpenCrop(false);localStorage.setItem(\"account\",JSON.stringify(data));queryClient.invalidateQueries([\"profile\"]);toast.success(\"Profile Photo is removed\");},onError:error=>{toast.error(error.message);console.log(error);}});// uploading the image/avatar\nconst handleFileChange=e=>{const file=e.target.files[0];setPhoto({url:URL.createObjectURL(file),file});setOpenCrop(true);};// for deleting the image/avatar\nconst handleDeleteImage=()=>{if(window.confirm(\"Are you sure you want to delete this image?\")){try{const formData=new FormData();formData.append(\"profilePicture\",undefined);mutate({token:userState.userInfo.token,formData:formData});}catch(error){toast.error(error.message);console.log(error);}}};return/*#__PURE__*/_jsxs(_Fragment,{children:[openCrop&&/*#__PURE__*/createPortal(/*#__PURE__*/_jsx(CropEasy,{photo:photo,setOpenCrop:setOpenCrop}),document.getElementById(\"portal\")),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-picture\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"profilePicture\",className:\"profile-label\",children:avatar?/*#__PURE__*/_jsx(\"img\",{src:stables.UPLOAD_FOLDER_BASE_URL+avatar,alt:\"Profile\",className:\"profile-img\"}):/*#__PURE__*/_jsx(\"div\",{className:\"profile-icon\",children:/*#__PURE__*/_jsx(IoPersonCircleOutline,{className:\"profile-icons\"})})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"profilePicture\",className:\"profile-input\",onChange:handleFileChange})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"profile-picture-del\",onClick:handleDeleteImage,children:\"Delete\"})]})]});};export default ProfilePicture;","map":{"version":3,"names":["React","useState","createPortal","stables","IoPersonCircleOutline","CropEasy","updateProfilePicture","useMutation","useQueryClient","useDispatch","useSelector","toast","userActions","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ProfilePicture","props","avatar","queryClient","dispatch","userState","state","user","openCrop","setOpenCrop","photo","setPhoto","mutate","isLoading","mutationFn","_ref","token","formData","onSuccess","data","setUserInfo","localStorage","setItem","JSON","stringify","invalidateQueries","success","onError","error","message","console","log","handleFileChange","e","file","target","files","url","URL","createObjectURL","handleDeleteImage","window","confirm","FormData","append","undefined","userInfo","children","document","getElementById","className","htmlFor","src","UPLOAD_FOLDER_BASE_URL","alt","type","id","onChange","onClick"],"sources":["C:/Users/moral/Desktop/Capstone Project JAR/JAR/src/components/ProfilePicture.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport { stables } from \"../constants\";\r\nimport { IoPersonCircleOutline } from \"react-icons/io5\";\r\nimport \"./css/profilepicture.css\";\r\nimport CropEasy from \"./crop/CropEasy\";\r\nimport { updateProfilePicture } from \"../services/index/users\";\r\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport toast from \"react-hot-toast\";\r\nimport { userActions } from \"../store/reducers/userReducers\";\r\n\r\nconst ProfilePicture = (props) => {\r\n   const { avatar } = props;\r\n   const queryClient = useQueryClient();\r\n   const dispatch = useDispatch();\r\n   const userState = useSelector((state) => state.user);\r\n   const [openCrop, setOpenCrop] = useState(false);\r\n   const [photo, setPhoto] = useState(null);\r\n\r\n   const { mutate, isLoading } = useMutation({\r\n      mutationFn: ({ token, formData }) => {\r\n         return updateProfilePicture({\r\n            token: token,\r\n            formData: formData,\r\n         });\r\n      },\r\n      onSuccess: (data) => {\r\n         dispatch(userActions.setUserInfo(data));\r\n         setOpenCrop(false);\r\n         localStorage.setItem(\"account\", JSON.stringify(data));\r\n         queryClient.invalidateQueries([\"profile\"]);\r\n         toast.success(\"Profile Photo is removed\");\r\n      },\r\n      onError: (error) => {\r\n         toast.error(error.message);\r\n         console.log(error);\r\n      },\r\n   });\r\n\r\n   // uploading the image/avatar\r\n   const handleFileChange = (e) => {\r\n      const file = e.target.files[0];\r\n      setPhoto({ url: URL.createObjectURL(file), file });\r\n      setOpenCrop(true);\r\n   };\r\n   // for deleting the image/avatar\r\n   const handleDeleteImage = () => {\r\n      if (window.confirm(\"Are you sure you want to delete this image?\")) {\r\n         try {\r\n            const formData = new FormData();\r\n            formData.append(\"profilePicture\", undefined);\r\n\r\n            mutate({ token: userState.userInfo.token, formData: formData });\r\n         } catch (error) {\r\n            toast.error(error.message);\r\n            console.log(error);\r\n         }\r\n      }\r\n   };\r\n\r\n   return (\r\n      <>\r\n         {openCrop &&\r\n            createPortal(\r\n               <CropEasy photo={photo} setOpenCrop={setOpenCrop} />,\r\n               document.getElementById(\"portal\")\r\n            )}\r\n         <div className=\"profile-container\">\r\n            <div className=\"profile-picture\">\r\n               {/* Checking if the user have an avatar/profile picture\r\n              from the uploads folder src={stables.UPLOAD_FOLDER_BASE_URL + avatar} */}\r\n               <label htmlFor=\"profilePicture\" className=\"profile-label\">\r\n                  {avatar ? (\r\n                     <img\r\n                        src={stables.UPLOAD_FOLDER_BASE_URL + avatar}\r\n                        alt=\"Profile\"\r\n                        className=\"profile-img\"\r\n                     />\r\n                  ) : (\r\n                     <div className=\"profile-icon\">\r\n                        <IoPersonCircleOutline className=\"profile-icons\" />\r\n                     </div>\r\n                  )}\r\n               </label>\r\n               <input\r\n                  type=\"file\"\r\n                  id=\"profilePicture\"\r\n                  className=\"profile-input\"\r\n                  onChange={handleFileChange}\r\n               />\r\n            </div>\r\n            <button\r\n               type=\"button\"\r\n               className=\"profile-picture-del\"\r\n               onClick={handleDeleteImage}\r\n            >\r\n               Delete\r\n            </button>\r\n         </div>\r\n      </>\r\n   );\r\n};\r\n\r\nexport default ProfilePicture;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}